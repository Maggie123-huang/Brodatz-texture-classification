import numpy
from sklearn.externals import joblib
from sklearn import svm
import pandas
import sys
from sklearn.cross_validation import train_test_split
sys.setrecursionlimit(6000)
seed = 7
numpy.random.seed(seed)

dataframe = pandas.read_csv("feature.txt", header=None)
dataset = dataframe.values

X = dataset[1:,0:88].astype(float)
Y = dataset[1:,88]
X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.30, random_state=42)

#clf = svm.SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
#    decision_function_shape='ovo', degree=3, gamma='auto', kernel='rbf',
#    max_iter=-1, probability=True, random_state=None, shrinking=True,
#    tol=0.001, verbose=True)
clf = svm.LinearSVC(C=1.0, class_weight=None, dual=True, fit_intercept=True,
     intercept_scaling=1, loss='squared_hinge', max_iter=1000,
     multi_class='ovr', penalty='l2', random_state=None, tol=0.0001,
     verbose=1)

clf.fit(X_train, y_train) 
print clf.score(X_train,y_train)
print clf.score(X_test,y_test)

dec = clf.decision_function([1.231833333333333513e+01,1.764000000000000412e+01,2.073454545454545794e+01,7.550115040553759815e-01,5.042992090083520118e-01,3.316667418208070761e-01,3.287180487219335673e-02,3.220914639556893277e-02,3.374674762412833984e-02,2.482383333333333155e+02,4.911565217391305396e+02,6.574327272727271065e+02,8.045430410142506705e-02,5.096741543009496167e-02,4.972897437828296269e-02,1.080555555555555089e-03,1.037429111531191052e-03,1.138842975206611581e-03,1.525878906250000339e-05,1.633233442911930295e-08,9.643701226929314529e+00,1.111191954865558813e+02,1.595138888888888218e+01,1.595138888888888218e+01,2.082986767485821744e+01,5.762575325608656485e-01,5.762575325608656485e-01,2.880148068964459296e-01,3.364205273450711353e-02,3.364205273450711353e-02,3.357716383427525320e-02,4.337881944444445708e+02,4.337881944444445708e+02,7.201455576559545761e+02,7.313828313850606611e-02,7.313828313850606611e-02,4.866113874306425557e-02,1.131787712191357521e-03,1.131787712191357521e-03,1.127425931153761994e-03,1.525878906250000000e-05,1.701478069625689034e-08,1.003085567379100063e+01,1.234713088215737002e+02,1.326666666666666572e+01,1.907130434782609285e+01,2.206909090909090665e+01,7.112954809522155086e-01,4.208825924511762073e-01,2.387550980998302819e-01,3.399346342395188902e-02,3.283688276260731537e-02,3.275251551754877061e-02,2.958433333333333621e+02,6.011060869565217217e+02,7.981600000000001955e+02,7.652903145955725073e-02,5.179155791256566388e-02,4.322679043640595409e-02,1.155555555555555069e-03,1.078260869565217514e-03,1.072727272727272939e-03,1.525878906250000000e-05,1.658520465019325835e-08,9.810397315438342147e+00,1.152334355989360404e+02,1.326666666666666572e+01,1.907130434782609285e+01,2.206909090909090665e+01,7.112954809522155086e-01,4.208825924511762073e-01,2.387550980998302819e-01,3.399346342395188902e-02,3.283688276260731537e-02,3.275251551754877061e-02,2.958433333333333621e+02,6.011060869565217217e+02,7.981600000000001955e+02,7.652903145955725073e-02,5.179155791256566388e-02,4.322679043640595409e-02,1.155555555555555069e-03,1.078260869565217514e-03,1.072727272727272939e-03,1.525878906250000000e-05,1.658520465019325835e-08,9.810397315438342147e+00,1.152334355989360404e+02])
print dec.shape[1] # 4 classes: 4*3/2 = 6

dec = clf.decision_function([1.231833333333333513e+01,1.764000000000000412e+01,2.073454545454545794e+01,7.550115040553759815e-01,5.042992090083520118e-01,3.316667418208070761e-01,3.287180487219335673e-02,3.220914639556893277e-02,3.374674762412833984e-02,2.482383333333333155e+02,4.911565217391305396e+02,6.574327272727271065e+02,8.045430410142506705e-02,5.096741543009496167e-02,4.972897437828296269e-02,1.080555555555555089e-03,1.037429111531191052e-03,1.138842975206611581e-03,1.525878906250000339e-05,1.633233442911930295e-08,9.643701226929314529e+00,1.111191954865558813e+02,1.595138888888888218e+01,1.595138888888888218e+01,2.082986767485821744e+01,5.762575325608656485e-01,5.762575325608656485e-01,2.880148068964459296e-01,3.364205273450711353e-02,3.364205273450711353e-02,3.357716383427525320e-02,4.337881944444445708e+02,4.337881944444445708e+02,7.201455576559545761e+02,7.313828313850606611e-02,7.313828313850606611e-02,4.866113874306425557e-02,1.131787712191357521e-03,1.131787712191357521e-03,1.127425931153761994e-03,1.525878906250000000e-05,1.701478069625689034e-08,1.003085567379100063e+01,1.234713088215737002e+02,1.326666666666666572e+01,1.907130434782609285e+01,2.206909090909090665e+01,7.112954809522155086e-01,4.208825924511762073e-01,2.387550980998302819e-01,3.399346342395188902e-02,3.283688276260731537e-02,3.275251551754877061e-02,2.958433333333333621e+02,6.011060869565217217e+02,7.981600000000001955e+02,7.652903145955725073e-02,5.179155791256566388e-02,4.322679043640595409e-02,1.155555555555555069e-03,1.078260869565217514e-03,1.072727272727272939e-03,1.525878906250000000e-05,1.658520465019325835e-08,9.810397315438342147e+00,1.152334355989360404e+02,1.326666666666666572e+01,1.907130434782609285e+01,2.206909090909090665e+01,7.112954809522155086e-01,4.208825924511762073e-01,2.387550980998302819e-01,3.399346342395188902e-02,3.283688276260731537e-02,3.275251551754877061e-02,2.958433333333333621e+02,6.011060869565217217e+02,7.981600000000001955e+02,7.652903145955725073e-02,5.179155791256566388e-02,4.322679043640595409e-02,1.155555555555555069e-03,1.078260869565217514e-03,1.072727272727272939e-03,1.525878906250000000e-05,1.658520465019325835e-08,9.810397315438342147e+00,1.152334355989360404e+02])
print dec
print clf.predict([8.395000000000003126e+00,1.299999999999999822e+01,1.530545454545454653e+01,7.964843908527617922e-01,5.353951705794341986e-01,3.594630808656010257e-01,3.760171390892826093e-02,3.581088744691130615e-02,3.544288852657805772e-02,1.140516666666666623e+02,2.643565217391303577e+02,3.658618181818181938e+02,1.219428671923142998e-01,7.080822603746336763e-02,5.550468136100761979e-02,1.413888888888889007e-03,1.282419659735349821e-03,1.256198347107438315e-03,1.525878906250000000e-05,1.987076008760713475e-08,1.177495777327808213e+01,1.809687229720337029e+02,1.134895833333333570e+01,1.134895833333333570e+01,1.540642722117202190e+01,6.135918406458419350e-01,6.135918406458419350e-01,3.387186867320680639e-01,3.682847818679933771e-02,3.682847818679933771e-02,3.569226387239925191e-02,2.108350694444444571e+02,2.108350694444444571e+02,3.642797731568997506e+02,1.019072470528399749e-01,1.019072470528399749e-01,6.153871110497379643e-02,1.356336805555554857e-03,1.356336805555554857e-03,1.273937700336976722e-03,1.525878906250000000e-05,2.004422499840081464e-08,1.169077523388789430e+01,1.750408989663652335e+02,9.161666666666668846e+00,1.332869565217391106e+01,1.499818181818181628e+01,7.322563963360061434e-01,4.605291379621730408e-01,3.170097034636131794e-01,3.765707842565000490e-02,3.564156788159860562e-02,3.618136134933164216e-02,1.426116666666665935e+02,2.841356521739130585e+02,3.571545454545455414e+02,1.179332420584533886e-01,7.544118445280811880e-02,6.880976996635999876e-02,1.418055555555554998e-03,1.270321361058601240e-03,1.309090909090909706e-03,1.525878906250000339e-05,2.009944436626145636e-08,1.293207674697955945e+01,2.897347739530741251e+02,9.161666666666668846e+00,1.332869565217391106e+01,1.499818181818181628e+01,7.322563963360061434e-01,4.605291379621730408e-01,3.170097034636131794e-01,3.765707842565000490e-02,3.564156788159860562e-02,3.618136134933164216e-02,1.426116666666665935e+02,2.841356521739130585e+02,3.571545454545455414e+02,1.179332420584533886e-01,7.544118445280811880e-02,6.880976996635999876e-02,1.418055555555554998e-03,1.270321361058601240e-03,1.309090909090909706e-03,1.525878906250000339e-05,2.009944436626145636e-08,1.293207674697955945e+01,2.897347739530741251e+02])


print clf.predict([8.168333333333333002e+00,1.129391304347826264e+01,1.346909090909090700e+01,8.356080140474577700e-01,6.771988026654404136e-01,5.362998046113719441e-01,3.698723503528691253e-02,3.595838804893101287e-02,3.565213009295923469e-02,1.074116666666667044e+02,2.050956521739130665e+02,2.890181818181818016e+02,1.143544955796707979e-01,9.158987643011873292e-02,8.061214996386963094e-02,1.368055555555555518e-03,1.293005671077504829e-03,1.271074380165289515e-03,1.525878906250000000e-05,1.976714582700946308e-08,1.160551608784362898e+01,1.715981952131407127e+02,9.519097222222221433e+00,9.519097222222221433e+00,1.277693761814744811e+01,7.742851537886834556e-01,7.742851537886834556e-01,5.769808876815716303e-01,3.745737675415176243e-02,3.745737675415176243e-02,3.667978811329348360e-02,1.468315972222222854e+02,1.468315972222222854e+02,2.636124763705104215e+02,1.169202408928601139e-01,1.169202408928601139e-01,7.872477526139522175e-02,1.403055073302468970e-03,1.403055073302468970e-03,1.345406856036105879e-03,1.525878906250000000e-05,2.088298298358422718e-08,1.276367516682844538e+01,2.301651963480385632e+02,7.554999999999999716e+00,8.819130434782605832e+00,1.036181818181818670e+01,8.712717865123567051e-01,8.110051446082736648e-01,7.312478884899671350e-01,3.721185593627684279e-02,3.750236287451795547e-02,3.752684989190962356e-02,8.623499999999997101e+01,1.245095652173912839e+02,1.748345454545454629e+02,1.176615204529999764e-01,1.057791608113024112e-01,1.013332762284430838e-01,1.384722222222221867e-03,1.406427221172022778e-03,1.408264462809917343e-03,1.525878906249999831e-05,2.112660047209236003e-08,1.271314094000480388e+01,2.203064046503139650e+02,7.554999999999999716e+00,8.819130434782605832e+00,1.036181818181818670e+01,8.712717865123567051e-01,8.110051446082736648e-01,7.312478884899671350e-01,3.721185593627684279e-02,3.750236287451795547e-02,3.752684989190962356e-02,8.623499999999997101e+01,1.245095652173912839e+02,1.748345454545454629e+02,1.176615204529999764e-01,1.057791608113024112e-01,1.013332762284430838e-01,1.384722222222221867e-03,1.406427221172022778e-03,1.408264462809917343e-03,1.525878906249999831e-05,2.112660047209236003e-08,1.271314094000480388e+01,2.203064046503139650e+02])

print dec.shape[1] # 4 classes
joblib.dump(clf, 'svm.pkl')
